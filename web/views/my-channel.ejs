<!DOCTYPE html>
<html lang="ko">
  <head>
    <title><%= user.username %>'s Channel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel='stylesheet' href='/css/style.css' />
    <script src="/js/index.js"></script>
  </head>
  <body>
    <section id="title">
      <h1 class="title">
        <a href="/">
          <%= user.username %>'s Channel
        </a>
      </h1>
    </section>
    <%- include('nav.ejs') %>
    
    <p style="padding: 0 1rem;">Welcome to your personal channel. Here you can manage your favorite YouTube videos.</p>
    
    <h2 style="padding: 0 1rem;">Add a new video</h2>
    <form action="/my-channel/add-video" method="POST" style="padding: 0 1rem; margin-bottom: 1rem;">
      <input type="text" name="videoUrl" placeholder="Enter YouTube Video URL" required style="padding: 0.3rem;">
      <button type="submit" style="padding: 0.3rem 0.6rem;">Add Video</button>
    </form>

    <hr>

    <h2 style="padding: 0 1rem;">Your Videos (<%= videos.length %> / <% if (user.subscriptionTier === 'free') { %>5<% } else { %>Unlimited<% } %>)</h2>
    
    <% if (user.subscriptionTier === 'free' && videos.length >= 5) { %>
      <div style="background-color: #fff3cd; padding: 1rem; margin: 1rem;">
        You have reached your 5 video limit. <a href="/subscribe">Upgrade to premium</a> for unlimited videos.
      </div>
    <% } %>

    <ul id="list">
      <% if (videos && videos.length > 0) { %>
        <% videos.forEach(function(video) { %>
          <li data-v="<%= video.videoId %>">
            <a href="https://youtu.be/<%= video.videoId %>" alt="<%= video.title %>" target="_blank">
              <img src="<%= video.thumbnail %>" alt="<%= video.title %>" loading="lazy" />
              <div>
                <%= video.title %>
              </div>
            </a>
            <form action="/my-channel/remove-video" method="POST" style="display: inline;">
              <input type="hidden" name="videoId" value="<%= video.videoId %>">
              <button type="submit" class="btn-remove">Remove</button>
            </form>
          </li>
        <% }); %>
      <% } else { %>
        <p style="padding: 1rem;">You have no videos yet. Add one using the form above.</p>
      <% } %>
    </ul>
    <%- include('footer') %>
  </body>
</html>
